model <- gam(age_H[['VIP']] ~ s(sa, k=k), data = age_H)
plot(model, se=TRUE, residuals=TRUE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
dev.off()
# Figure3A
k = 3
colfunc <- colorRampPalette(c("yellow","purple"))(11)
postscript('Fig3A_a.eps')
model <- gam(age_H[['PV']] ~ s(sa, k=k), data = age_H)
# Figure3A
k = 3
colfunc <- colorRampPalette(c("yellow","purple"))(11)
postscript('Fig3A_a.eps')
model <- gam(age_H[['PVALB']] ~ s(sa, k=k), data = age_H)
plot(model, se=TRUE, residuals=TRUE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
dev.off()
marker <- 'GAD2' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
postscript(paste(marker, '.eps'))
model <- gam(zscore(age_H[[marker]]) ~ s(sa, k=k), data = age_H)
marker <- 'GAD2' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
postscript(paste(marker, '.eps'))
model <- gam(scale(age_H[[marker]]) ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = GAD2, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(0,5)
print(summary(model))
dev.off()
marker <- 'GAD2' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
postscript(paste(marker, '.eps'))
model <- gam(scale(age_H[[marker]]) ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = scale(age_H[[marker]]), fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(0,5)
print(summary(model))
dev.off()
marker <- 'GAD2' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = GAD2, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(0,5)
print(summary(model))
dev.off()
marker <- 'PVALB' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = PVLAB, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(2,9)
marker <- 'PVALB' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = PVALB, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(2,9)
print(summary(model))
dev.off()
marker <- 'PVALB' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_Hr <- age_H[age_H$sa==0, ]
postscript(paste(marker, '_age_v.eps'))
model <- gam(age_Hr[[marker]] ~ s(rank, k=k), data = age_Hr)
pred <- predict(model, se.fit=T)
ggplot(data = age_Hr, mapping = aes(x = rank, y = PVALB, fill = rank)) +
geom_point(aes(x=rank, color=rank)) +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) #+ ylim(2,9)
print(summary(model))
dev.off()
marker <- 'PVALB' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = PVALB, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) #+ ylim(2,9)
print(summary(model))
dev.off()
marker <- 'PVALB' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = PVALB, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(-2,2.5)
print(summary(model))
dev.off()
marker <- 'SST' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = SST, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(-2,2.5)
print(summary(model))
dev.off()
marker <- 'VIP' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = VIP, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(-2,2.5)
print(summary(model))
dev.off()
library(ggseg)
library(ggseg3d)
library(ggsegBrodmann)
library(ggsegSchaefer)
library(WVPlots)
library(clue)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggExtra)
library(cowplot)
theme_set(theme_cowplot())
library(corrplot)
library(visreg)
library(ggcorrplot)
library(ggseg3d)
library(ggseg)
library(ggsegSchaefer)
library(ggsegYeo2011)
library(psych)
library(nlme)
library(mgcv)
library(gratia)
load(file="/Users/monaminishio/Desktop/HOME30/202402_paper/Modules/human/brodmann_3d.rda")
lh_label <- brodmann_3d$ggseg_3d[[1]]['region'][2:40,1:1]
rh_label <- brodmann_3d$ggseg_3d[[2]]['region'][2:40,1:1]
label  <-rbind(lh_label, rh_label)
brod <- read.csv('/Users/monaminishio/Desktop/HOME30/202402_paper/Dataset/rna/brodmann.csv')
#brod['region'] <- label
load(file="/Users/monaminishio/Desktop/HOME30/202402_paper/Modules/human/schaefer17_400_3d.RData")
lh_label <- schaefer17_400_3d$ggseg_3d[[1]]['region'][2:201,1:1]
rh_label <- schaefer17_400_3d$ggseg_3d[[2]]['region'][2:201,1:1]
label  <-rbind(lh_label, rh_label)
schaefer <- read.csv('/Users/monaminishio/Desktop/HOME30/202402_paper/Dataset/rna/schaefer.csv')
schaefer['region'] <- label
b <- ggseg(brod, atlas = brodmann, mapping = aes(fill = sa),
position = "stacked") + theme_void() +
scale_fill_gradient(low = "yellow", high = "purple",limits = c(0, 10)) +  labs(title="Aparc plots rule") +
theme_brain(text.size=16) + theme(legend.position = "bottom",
legend.text = element_text(size = 9)) +
guides(fill = guide_legend(ncol = 6))
ggsave(filename ='../figures/Figure1B_fix.eps', device = "pdf", dpi = 500)
library(ggseg)
library(ggseg3d)
library(ggsegBrodmann)
library(ggsegSchaefer)
library(WVPlots)
library(clue)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggExtra)
library(cowplot)
theme_set(theme_cowplot())
library(corrplot)
library(visreg)
library(ggcorrplot)
library(ggseg3d)
library(ggseg)
library(ggsegSchaefer)
library(ggsegYeo2011)
library(psych)
library(nlme)
library(mgcv)
library(gratia)
load(file="/Users/monaminishio/Desktop/HOME38/202402_paper/Modules/human/brodmann_3d.rda")
lh_label <- brodmann_3d$ggseg_3d[[1]]['region'][2:40,1:1]
rh_label <- brodmann_3d$ggseg_3d[[2]]['region'][2:40,1:1]
label  <-rbind(lh_label, rh_label)
brod <- read.csv('/Users/monaminishio/Desktop/HOME38/202402_paper/Dataset/rna/brodmann.csv')
#brod['region'] <- label
load(file="/Users/monaminishio/Desktop/HOME38/202402_paper/Modules/human/schaefer17_400_3d.RData")
lh_label <- schaefer17_400_3d$ggseg_3d[[1]]['region'][2:201,1:1]
rh_label <- schaefer17_400_3d$ggseg_3d[[2]]['region'][2:201,1:1]
label  <-rbind(lh_label, rh_label)
schaefer <- read.csv('/Users/monaminishio/Desktop/HOME38/202402_paper/Dataset/rna/schaefer.csv')
schaefer['region'] <- label
View(brod)
View(brod)
library(ggseg)
library(ggseg3d)
library(ggsegBrodmann)
library(ggsegSchaefer)
library(WVPlots)
library(clue)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggExtra)
library(cowplot)
theme_set(theme_cowplot())
library(corrplot)
library(visreg)
library(ggcorrplot)
library(ggseg3d)
library(ggseg)
library(ggsegSchaefer)
library(ggsegYeo2011)
library(psych)
library(nlme)
library(mgcv)
library(gratia)
load(file="/Users/monaminishio/Desktop/HOME38/202402_paper/Modules/human/brodmann_3d.rda")
lh_label <- brodmann_3d$ggseg_3d[[1]]['region'][2:40,1:1]
rh_label <- brodmann_3d$ggseg_3d[[2]]['region'][2:40,1:1]
label  <-rbind(lh_label, rh_label)
brod <- read.csv('/Users/monaminishio/Desktop/HOME38/202402_paper/Dataset/rna/brodmann.csv')
#brod['region'] <- label
load(file="/Users/monaminishio/Desktop/HOME38/202402_paper/Modules/human/schaefer17_400_3d.RData")
lh_label <- schaefer17_400_3d$ggseg_3d[[1]]['region'][2:201,1:1]
rh_label <- schaefer17_400_3d$ggseg_3d[[2]]['region'][2:201,1:1]
label  <-rbind(lh_label, rh_label)
schaefer <- read.csv('/Users/monaminishio/Desktop/HOME38/202402_paper/Dataset/rna/schaefer.csv')
schaefer['region'] <- label
b <- ggseg(brod, atlas = brodmann, mapping = aes(fill = sa),
position = "stacked") + theme_void() +
scale_fill_gradient(low = "yellow", high = "purple",limits = c(0, 10)) +  labs(title="Aparc plots rule") +
theme_brain(text.size=16) + theme(legend.position = "bottom",
legend.text = element_text(size = 9)) +
guides(fill = guide_legend(ncol = 6))
ggsave(filename ='../figures/Figure1B_fix.eps', device = "pdf", dpi = 500)
b <- ggseg(brod, atlas = brodmann, mapping = aes(fill = sa),
position = "stacked") + theme_void() +
scale_fill_gradient(low = "yellow", high = "purple",limits = c(0, 10)) +  labs(title="Aparc plots rule") +
theme_brain(text.size=16) + theme(legend.position = "bottom",
legend.text = element_text(size = 9)) +
guides(fill = guide_legend(ncol = 6))
ggsave(filename ='Figure1B_fix.eps', device = "pdf", dpi = 500)
library(ggseg)
library(ggseg3d)
library(ggsegBrodmann)
library(ggsegSchaefer)
library(WVPlots)
library(clue)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(ggExtra)
library(cowplot)
theme_set(theme_cowplot())
library(corrplot)
library(visreg)
library(ggcorrplot)
library(ggseg3d)
library(ggseg)
library(ggsegSchaefer)
library(ggsegYeo2011)
library(psych)
library(nlme)
library(mgcv)
library(gratia)
load(file="/Users/monaminishio/Desktop/HOME38/202402_paper/Modules/human/brodmann_3d.rda")
lh_label <- brodmann_3d$ggseg_3d[[1]]['region'][2:40,1:1]
rh_label <- brodmann_3d$ggseg_3d[[2]]['region'][2:40,1:1]
label  <-rbind(lh_label, rh_label)
brod <- read.csv('/Users/monaminishio/Desktop/HOME38/202402_paper/Dataset/rna/brodmann.csv')
#brod['region'] <- label
load(file="/Users/monaminishio/Desktop/HOME38/202402_paper/Modules/human/schaefer17_400_3d.RData")
lh_label <- schaefer17_400_3d$ggseg_3d[[1]]['region'][2:201,1:1]
rh_label <- schaefer17_400_3d$ggseg_3d[[2]]['region'][2:201,1:1]
label  <-rbind(lh_label, rh_label)
schaefer <- read.csv('/Users/monaminishio/Desktop/HOME38/202402_paper/Dataset/rna/schaefer.csv')
schaefer['region'] <- label
b <- ggseg(brod, atlas = brodmann, mapping = aes(fill = sa),
position = "stacked") + theme_void() +
scale_fill_gradient(low = "yellow", high = "purple",limits = c(0, 10)) +  labs(title="Aparc plots rule") +
theme_brain(text.size=16) + theme(legend.position = "bottom",
legend.text = element_text(size = 9)) +
guides(fill = guide_legend(ncol = 6))
ggsave(filename ='Figure1B_fix.eps', device = "pdf", dpi = 500)
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github("WinVector/WVPlots")
library(WVPlots)
library(clue)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggExtra)
library(cowplot)
library(car)
theme_set(theme_cowplot())
library(corrplot)
library(visreg)
library(ggcorrplot)
library(ggseg3d)
library(ggseg)
library(ggsegSchaefer)
library(ggsegYeo2011)
library(psych)
library(nlme)
library(mgcv)
library(gratia)
age_H <- read.csv("RNA.csv")
k=3
marker <- 'VIP' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = VIP, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(-2,2.5)
print(summary(model))
dev.off()
marker <- 'SST' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = SST, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(-2,2.5)
print(summary(model))
dev.off()
marker <- 'PVALB' #'PVALB', 'SST', 'VIP', 'GAD1', 'GAD2'
age_H[[marker]] <- scale(age_H[[marker]])
postscript(paste(marker, '.eps'))
model <- gam(age_H[[marker]] ~ s(sa, k=k), data = age_H)
pred <- predict(model, se.fit=T)
ggplot(data = age_H, mapping = aes(x = sa, y = PVALB, fill = sa)) +
geom_point(aes(x=sa, color=sa)) + scale_color_gradient(low='yellow', high='purple') +
geom_ribbon(aes(ymin=pred$fit-1.96*pred$se.fit,
ymax=pred$fit+1.96*pred$se.fit), alpha = 1, fill = 'gray') +
geom_smooth(method="gam", formula= y~s(x, k=k)) + ylim(-2,2.5)
print(summary(model))
dev.off()
# Figure3A
k = 3
postscript('Fig3A_VIP_average.eps')
model <- gam(age_Hr[['VIP']] ~ s(rank, k=k), data = age_Hr)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
dev.off()
View(derv)
View(derv)
# Figure3A
k = 3
postscript('Fig3A_VIP_average.eps')
model <- gam(age_H[['VIP']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
dev.off()
# Figure3A
k = 3
postscript('Fig3A_VIP_average.eps')
model <- gam(age_H[['VIP']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
increasing.range <- derv[['rank']][derv[['.lower_ci']] > 0]
plot(c(max(increasing.range),max(increasing.range)), c(-1,1), ylim=c(-2,1.5),type="l")
dev.off()
# Figure3A
k = 3
postscript('Fig3A_SST_average.eps')
model <- gam(age_H[['SST']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
increasing.range <- derv[['rank']][derv[['.lower_ci']] > 0]
plot(c(max(increasing.range),max(increasing.range)), c(-1,1), ylim=c(-2,1.5),type="l")
dev.off()
# Figure3A
k = 3
postscript('Fig3A_PVALB_average.eps')
model <- gam(age_H[['PVALB']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
increasing.range <- derv[['rank']][derv[['.lower_ci']] > 0]
plot(c(max(increasing.range),max(increasing.range)), c(-1,1), ylim=c(-2,1.5),type="l")
dev.off()
# Figure3A
k = 3
postscript('Fig3A_PVALB_average.eps')
model <- gam(age_H[['PVALB']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
print(summary(model))
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
increasing.range <- derv[['rank']][derv[['.lower_ci']] > 0]
plot(c(max(increasing.range),max(increasing.range)), c(-1,1), ylim=c(-2,1.5),type="l")
dev.off()
# Figure3A
k = 3
postscript('Fig3A_SST_average.eps')
model <- gam(age_H[['SST']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
print(summary(model))
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
increasing.range <- derv[['rank']][derv[['.lower_ci']] > 0]
plot(c(max(increasing.range),max(increasing.range)), c(-1,1), ylim=c(-2,1.5),type="l")
dev.off()
# Figure3A
k = 3
postscript('Fig3A_VIP_average.eps')
model <- gam(age_H[['VIP']] ~ s(rank, k=k), data = age_H)
plot(model, se=TRUE, residuals=FALSE, shade=TRUE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
print(summary(model))
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)
increasing.range <- derv[['rank']][derv[['.lower_ci']] > 0]
plot(c(max(increasing.range),max(increasing.range)), c(-1,1), ylim=c(-2,1.5),type="l")
dev.off()
# Figure3A
k = 3
colfunc <- colorRampPalette(c("yellow","purple"))(11)
postscript('Fig3A_VIP.eps')
for (n in 0:10){
age_Hr <- age_H[age_H$sa==n, ]
model <- gam(age_Hr[['VIP']] ~ s(rank, k=k), data = age_Hr)
plot(model, se=FALSE, residuals=FALSE, shade=FALSE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model))
par(new=T)}
dev.off()
a <- summary(model)
View(a)
View(a)
a <- summary(model)$r.sq
# Figure3A
k = 3
colfunc <- colorRampPalette(c("yellow","purple"))(11)
postscript('Fig3A_VIP.eps')
for (n in 0:10){
age_Hr <- age_H[age_H$sa==n, ]
model <- gam(age_Hr[['VIP']] ~ s(rank, k=k), data = age_Hr)
plot(model, se=FALSE, residuals=FALSE, shade=FALSE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model)$r.sq)
par(new=T)}
dev.off()
# Figure3A
k = 3
colfunc <- colorRampPalette(c("yellow","purple"))(11)
postscript('Fig3A_PVALB.eps')
for (n in 0:10){
age_Hr <- age_H[age_H$sa==n, ]
model <- gam(age_Hr[['PVALB']] ~ s(rank, k=k), data = age_Hr)
plot(model, se=FALSE, residuals=FALSE, shade=FALSE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model)$r.sq)
par(new=T)}
dev.off()
# Figure3A
k = 3
colfunc <- colorRampPalette(c("yellow","purple"))(11)
postscript('Fig3A_PVALB.eps')
for (n in 0:10){
age_Hr <- age_H[age_H$sa==n, ]
model <- gam(age_Hr[['PVALB']] ~ s(rank, k=k), data = age_Hr)
plot(model, se=FALSE, residuals=FALSE, shade=FALSE, col=colfunc[n+1],ylim=c(-2,1.5),  ylab='Hurst Exponent (z-scored)', xlab='Age')
derv <- derivatives(model, interval = "simultaneous", unconditional = F)
print(summary(model)$r.sq)
par(new=T)}
dev.off()
View(age_H)
View(age_H)
